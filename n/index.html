<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="images/favicon.png">
    <link href="https://thatdownnomorry.github.io/set/n/cocolo.css" rel="stylesheet" />
    <title>ココロサーチ@nifty</title>
</head>
<body bgcolor="black">

<div class="mainarea">
	<div id="container">
		<div id="header"></div>
	                <div id="mainContents">
			<div class="mainContents_in" id="maincontents_in">
				<div class="search_mdl">
					<h3 class="search_title_bar"><img class="" src="images/ttl_search.png"  alt="ココロサーチ" ></h3>
					<div  class="search_mdl_in">
						<form name="cocolo_form" id="searchForm" method="get">
						    <span>
 					       	    <input id="form_text" maxlength="125" type="text" name="q" value="" style="color:#444444;font-size:140%;line-height:1.3;">
					    	    </span>
						    <input type="image" id="searchButton" alt="ココロに探してもらう" title="ココロに探してもらう" value="検索" src="images/btn_search.gif" name="submit" hsrc="images/btn_search_on.gif" class="imgover">
						</form>
					</div>
				</div>
			</div>
		</div>
		<div id="contentsBtm">
			<div id="kw_mdl">
				<h3 class="keyword_title_bar">
					<img src="images/ttl_kw.png" alt="人気のキーワード" title="人気のキーワード">
				</h3>
				<div class="kw_mdl_in">
					<div class="kw_mdl_main">
						<ul id="keywordList"></ul>
					</div>
				</div>
			</div>
		</div>
	</div>




</div>






    <!-- JavaScriptのコードをここに追加 -->
<script type="text/javascript">
// 最後の操作時間を記録する変数
let lastActivityTime = Date.now();

// 2分間の無操作後に遷移するURL
const redirectUrl = 'https://thatdownnomorry.github.io/set/vista/vista.html';  // 適切なURLに変更してください

// 2分間の無操作を検出するタイマーを設定
function checkInactivity() {
    const currentTime = Date.now();
    const timeElapsed = currentTime - lastActivityTime;

    if (timeElapsed > 5 * 60 * 1000) { // 2分 (120,000ミリ秒)
        window.location.href = redirectUrl;
    }
}

// 最後の操作時間を更新する関数
function resetInactivityTimer() {
    lastActivityTime = Date.now();
}

// ページのロード時にイベントリスナーを設定
window.addEventListener('load', function() {
    // キーボード、マウスの動作、スクロールなどを検出してタイマーをリセット
    document.addEventListener('keydown', resetInactivityTimer);
    document.addEventListener('mousemove', resetInactivityTimer);
    document.addEventListener('scroll', resetInactivityTimer);
    document.addEventListener('click', resetInactivityTimer);
    
    // 定期的に無操作時間をチェックするタイマーを設定
    setInterval(checkInactivity, 5000); // 5秒ごとにチェック
});






// 背景画像の候補リスト for mainarea
const backgroundImagesMainArea = [
    'url(images/random_bg/1.jpg)',
    'url(images/random_bg/2.jpg)',
    'url(images/random_bg/3.jpg)',
    'url(images/random_bg/4.jpg)',
    'url(images/random_bg/5.jpg)',
    'url(images/random_bg/6.jpg)',
    'url(images/random_bg/7.jpg)',
    'url(images/random_bg/8.jpg)',
    'url(images/random_bg/9.jpg)',
    'url(images/random_bg/10.jpg)',
    'url(images/random_bg/11.jpg)',
    'url(images/random_bg/12.jpg)',
    'url(images/random_bg/13.jpg)',
    'url(images/random_bg/14.jpg)'
];

// 背景画像の候補リスト for kw_mdl_main
const backgroundImagesKwMdlMain = [
    'url(images/img_cocolo_s.png)',
    'url(images/cocolo2.gif)'
];


// 特定の画像に対して#containerのCSSを設定する関数
function adjustContainerStyleForSpecificImages(backgroundImage, containerElement) {
    switch (backgroundImage) {
        case 'url(images/random_bg/4.jpg)':
            containerElement.style.opacity = '100%';
            break;
        case 'url(images/random_bg/14.jpg)':
            containerElement.style.opacity = '85%';
            break;
        // 他の特定の画像に対するCSSを追加
        default:
            // デフォルトのスタイルを設定
            containerElement.style.border = '';
            containerElement.style.padding = '';
            containerElement.style.backgroundColor = '';
            break;
    }
}

// ランダムな画像を選んで背景に適用する関数 for mainarea
function setRandomBackgroundImageMainArea() {
    const mainArea = document.querySelector('.mainarea');
    const container = document.getElementById('container');
    const randomImage = backgroundImagesMainArea[Math.floor(Math.random() * backgroundImagesMainArea.length)];
    mainArea.style.backgroundImage = randomImage;

    // 背景画像に応じた#containerのスタイルを調整
    adjustContainerStyleForSpecificImages(randomImage, container);
}

// ランダムな画像を選んで背景に適用する関数 for kw_mdl_main
function setRandomBackgroundImageKwMdlMain() {
    const kwMdlMain = document.querySelector('.kw_mdl_main');
    const container = document.getElementById('container');
    const randomImage = backgroundImagesKwMdlMain[Math.floor(Math.random() * backgroundImagesKwMdlMain.length)];
    kwMdlMain.style.backgroundImage = randomImage;

    // 背景画像に応じた#containerのスタイルを調整
    adjustContainerStyleForSpecificImages(randomImage, container);
}

// ページ読み込み時にランダムな背景画像を設定
window.addEventListener('load', function() {
    setRandomBackgroundImageMainArea();
    setRandomBackgroundImageKwMdlMain();
});







document.getElementById('searchButton').addEventListener('click', function(event) {
    event.preventDefault(); // フォームのデフォルトの送信を防ぐ
    
    const searchBox = document.getElementById('form_text');
    const keyword = searchBox.value.trim();


    // "＠ぴざ" または "＠ピザ" が入力された場合にピザのURLに飛ぶ
    if (keyword === '@ぴざ' || keyword === '@ピザ' || keyword === '＠ぴざ' || keyword === '＠ピザ') {
        window.open('https://www.pizza-la.co.jp/First.aspx', '_blank');
        return;
    }

    // nicovideo.jp が含まれている場合はその URL を開く
    if (keyword.includes('nicovideo.jp')) {
        window.open(keyword, '_blank');
        return;
    }


    if (keyword) {
        // Google検索を新しいタブで開く
        window.open(`https://www.google.com/search?q=${encodeURIComponent(keyword)}`, '_blank');

        // ローカルストレージにキーワードを保存
        let keywords = JSON.parse(localStorage.getItem('popularKeywords')) || [];
        
        // キーワードが既に存在するか確認
        const keywordIndex = keywords.indexOf(keyword);

        if (keywordIndex === -1) {
            // キーワードが存在しない場合のみ追加
            keywords.push(keyword);
            localStorage.setItem('popularKeywords', JSON.stringify(keywords));
        } else {
            // キーワードが既に存在する場合は、リストの末尾に移動
            keywords.splice(keywordIndex, 1); // 既存のキーワードを削除
            keywords.push(keyword); // 末尾に追加
            localStorage.setItem('popularKeywords', JSON.stringify(keywords));
        }

        // キーワードリストを更新
        updateKeywordList();

    }
});





function updateKeywordList() {
    const keywords = JSON.parse(localStorage.getItem('popularKeywords')) || [];
    const keywordList = document.getElementById('keywordList');
    
    // 現在のリストの子要素を全て削除
    keywordList.innerHTML = '';

    // 最大表示数
    const maxItems = 35;

    // 最新のキーワードから maxItems 個を表示
    const itemsToShow = keywords.slice(-maxItems);

    itemsToShow.forEach(function(keyword) {
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = `https://www.google.com/search?q=${encodeURIComponent(keyword)}`;
        a.textContent = keyword;

        // 文字数に応じたクラスの設定
        if (keyword.length >= 7) {
            a.className = 'txt1';
        } else if (keyword.length >= 4) {
            a.className = 'txt3';
        } else if (keyword.length > 0) {
            a.className = 'txt5';
        }

        // 新しいアイテムをリストの最初に追加
        keywordList.insertBefore(li, keywordList.firstChild);
        li.appendChild(a);
    });
}

// ページ読み込み時にキーワードリストを更新
window.addEventListener('load', updateKeywordList);

</script>
</body>
</html>
